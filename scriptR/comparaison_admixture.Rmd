---
title: "Comparaison des taux d'admixture calculés par MetHis avec ceux calculés par ADMIXTURE"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/Documents/git_repository/Stage/Simulations/SNP_AFR_EUR/new_methis_pop_size_diff_50000_snp")
# knitr::opts_knit$set(root.dir = "~/Documents/git_repository/Stage/Simulations/SNP_AFR_EUR/new_methis_bottleneck_50000_snp/alpha0.1/Nu0.01/bottle10/")

```

## Indicateur de temps
```{r}
time.ini = Sys.time()
```

Chargement des libraries et fonctions
```{r}
source("../../../scriptR/functions.R")
```


```{r}
setwd("../test_logiciel_admixture/Ne_cst/s1.0_0.75/gen80")

df_methis = data.frame.stat(seq_ne = c(100), max_gen = 81, max_simu = 1)
df_methis_gen0 = df_methis[which(df_methis$Generation == 0),]
df_methis_gen2 = df_methis[which(df_methis$Generation == 2),]
df_methis_gen20 = df_methis[which(df_methis$Generation == 20),]
df_methis_gen50 = df_methis[which(df_methis$Generation == 50),]
df_methis_gen80 = df_methis[which(df_methis$Generation == 80),]
```

```{r}
hist_one_line = function(df, color = "#F6DC12", color2 = "#F9429E"){
  vec_y = c(df$perc0.adm.props,
            df$perc10.adm.props,
            df$perc20.adm.props,
            df$perc30.adm.props,
            df$perc40.adm.props,
            df$perc50.adm.props,
            df$perc60.adm.props,
            df$perc70.adm.props,
            df$perc80.adm.props,
            df$perc90.adm.props,
            df$perc100.adm.props)
  
  hist(vec_y, breaks = vec_y, main=df$Generation, col = color, xlim = c(-0.1, 1.1))
  abline(v = df$mean.adm.props, col = color2, lty = 2, lwd=3)

}


```

```{r}
plot_stat_gen(df = df_methis, stat = df_methis$mean.adm.props,gen = df_methis$Generation,
              group_col = c(), color_col = df_methis$Ne,titre = "")
```


```{r}
hist_one_line(df_methis_gen0)
hist_one_line(df_methis_gen2)
hist_one_line(df_methis_gen20)
hist_one_line(df_methis_gen50)
hist_one_line(df_methis_gen80)
```

```{r}
setwd("../../../tools/admixture_alexander/dist/test_adm_075/")

df_adm_g0 = read.table("simu_1_g0.2.Q", header = FALSE)
df_adm_g0 = df_adm_g0[1:50,]
df_adm_g2 = read.table("simu_1_g2.2.Q", header = FALSE)
df_adm_g2 = df_adm_g2[1:50,]
df_adm_g20 = read.table("simu_1_g20.2.Q", header = FALSE)
df_adm_g20 = df_adm_g20[1:50,]
df_adm_g50 = read.table("simu_1_g50.2.Q", header = FALSE)
df_adm_g50 = df_adm_g50[50:100,]
df_adm_g80 = read.table("simu_1_g80.2.Q", header = FALSE)
df_adm_g80 = df_adm_g80[50:100,]
```


```{r}
hist(df_adm_g0$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g0$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g2$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g2$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g20$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g20$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g50$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g50$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g80$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g80$V1), col = "#F9429E", lty = 2, lwd=3)
```


```{r}
setwd("../test_logiciel_admixture/Ne_cst/s1.0_0.5/gen80")

df_methis = data.frame.stat(seq_ne = c(100), max_gen = 81, max_simu = 1)
df_methis_gen0 = df_methis[which(df_methis$Generation == 0),]
df_methis_gen2 = df_methis[which(df_methis$Generation == 2),]
df_methis_gen20 = df_methis[which(df_methis$Generation == 20),]
df_methis_gen50 = df_methis[which(df_methis$Generation == 50),]
df_methis_gen80 = df_methis[which(df_methis$Generation == 80),]

```

```{r}
hist_one_line(df_methis_gen0)
hist_one_line(df_methis_gen2)
hist_one_line(df_methis_gen20)
hist_one_line(df_methis_gen50)
hist_one_line(df_methis_gen80)
```


```{r}
setwd("../../../tools/admixture_alexander/dist/test_adm_05/")

df_adm_g0 = read.table("simu_1_g0.2.Q", header = FALSE)
df_adm_g0 = df_adm_g0[1:50,]
df_adm_g2 = read.table("simu_1_g2.2.Q", header = FALSE)
df_adm_g2 = df_adm_g2[1:50,]
df_adm_g20 = read.table("simu_1_g20.2.Q", header = FALSE)
df_adm_g20 = df_adm_g20[1:50,]
df_adm_g50 = read.table("simu_1_g50.2.Q", header = FALSE)
df_adm_g50 = df_adm_g50[100:150,]
df_adm_g80 = read.table("simu_1_g80.2.Q", header = FALSE)
df_adm_g80 = df_adm_g80[100:150,]
```

```{r}
hist(df_adm_g0$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g0$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g2$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g2$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g20$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g20$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g50$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g50$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g80$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g80$V1), col = "#F9429E", lty = 2, lwd=3)
```


```{r}
setwd("../test_logiciel_admixture/Ne_cst/s1.0_0.1/gen80")

df_methis = data.frame.stat(seq_ne = c(100), max_gen = 81, max_simu = 1)
df_methis_gen0 = df_methis[which(df_methis$Generation == 0),]
df_methis_gen2 = df_methis[which(df_methis$Generation == 2),]
df_methis_gen20 = df_methis[which(df_methis$Generation == 20),]
df_methis_gen50 = df_methis[which(df_methis$Generation == 50),]
df_methis_gen80 = df_methis[which(df_methis$Generation == 80),]

```

```{r}
hist_one_line(df_methis_gen0)
hist_one_line(df_methis_gen2)
hist_one_line(df_methis_gen20)
hist_one_line(df_methis_gen50)
hist_one_line(df_methis_gen80)
```


```{r}
setwd("../../../tools/admixture_alexander/dist/test_adm_01/")

df_adm_g0 = read.table("simu_1_g0.2.Q", header = FALSE)
df_adm_g0 = df_adm_g0[1:50,]
df_adm_g2 = read.table("simu_1_g2.2.Q", header = FALSE)
df_adm_g2 = df_adm_g2[1:50,]
df_adm_g20 = read.table("simu_1_g20.2.Q", header = FALSE)
df_adm_g20 = df_adm_g20[1:50,]
df_adm_g50 = read.table("simu_1_g50.2.Q", header = FALSE)
df_adm_g50 = df_adm_g50[100:150,]
df_adm_g80 = read.table("simu_1_g80.2.Q", header = FALSE)
df_adm_g80 = df_adm_g80[100:150,]
```


```{r}
hist(df_adm_g0$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g0$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g2$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g2$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g20$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g20$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g50$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g50$V1), col = "#F9429E", lty = 2, lwd=3)
hist(df_adm_g80$V1, col = "#F6DC12", xlim = c(-0.1, 1.1))
abline(v = mean(df_adm_g80$V1), col = "#F9429E", lty = 2, lwd=3)
```

