---
title: "Représentation des stats calculées par MetHis (50 000 SNP) pour des scénarios d'admixture simple multi simu"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/Documents/git_repository/Stage/Simulations/SNP_AFR_EUR/new_methis_pop_size_diff_50000_snp")
# knitr::opts_knit$set(root.dir = "~/Documents/git_repository/Stage/Simulations/SNP_AFR_EUR/new_methis_bottleneck_50000_snp/alpha0.1/Nu0.01/bottle10/")

```

## Indicateur de temps
```{r}
time.ini = Sys.time()
```

Chargement des libraries et fonctions
```{r}
source("../../../scriptR/functions.R")
```

### Enregistrement des fonctions
```{r}
print(difftime(Sys.time(), time.ini))
```

##Admixture récurrente

###Ne constant
```{r}
setwd("../../SNP_YRI_GBR_adm_multi/pulse_recurrent/Ne_cst/")

lst_ne_cst_adm_rec = list()
cpt = 1
vec_val_s10 = c(0.1, 0.5, 0.75)

for (val_s10 in vec_val_s10) {
  setwd(str_c("s1.0_", val_s10,"/"))
  lst_ne_cst_adm_rec[[cpt]] = data.frame.stat(seq_ne = c(100,1000,10000),
                                               max_gen = 101, max_simu = 1)
  lst_ne_cst_adm_rec[[cpt]] = delta.adm.gen.0(lst_ne_cst_adm_rec[[cpt]])
  cpt = cpt + 1
  setwd("../")
}

```

```{r}

for (i in c(1:3)) {
  write_cstt_plot(name_stat = "mean.het.adm", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/mean.he/Ne_cst/he_mean_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = 0.047,max_y = 0.065)
  write_cstt_plot(name_stat = "Fst.s1.adm", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/Fst.s1.adm/Ne_cst/fst_s1_adm_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = 0,max_y = 0.1)
  write_cstt_plot(name_stat = "Fst.s2.adm", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/Fst.s2.adm/Ne_cst/fst_s2_adm_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = 0,max_y = 0.1)
  write_cstt_plot(name_stat = "mean.F.adm", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/mean.F/Ne_cst/F_mean_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = -0.03,max_y = 0.02)
  write_cstt_plot(name_stat = "f3", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/f3/Ne_cst/f3_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = -0.05,max_y = 0.05)
  write_cstt_plot(name_stat = "perc50.adm.props", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/mean.adm/Ne_cst/mean_adm_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = 0,max_y = 0.8)
  write_cstt_plot(name_stat = "delta.adm.gen.0", mat = lst_ne_cst_adm_rec[[i]],
                  name_file =  str_c("pulse_recurrent/delta.adm0.adm/Ne_cst/delta_adm0_adm_ne_cst_multi_s10_",
                                     vec_val_s10[i]),
                  min_y = -0.8,max_y = 0.8)

}

```


###Ne croissant
```{r}
setwd("../../SNP_YRI_GBR_adm_multi/pulse_recurrent/Ne_inc/")

seq_nu = sprintf("%.2f", c(0.01, 0.25, 0.49))
seq_ne_ini = c(100)
seq_ne_fin = c(500,1000,10000)
seq_combi = as.data.frame(outer(seq_ne_ini, seq_ne_fin, FUN="paste", sep="-"))
seq_combi = as.data.frame.vector(unlist(seq_combi))[[1]]

lst_ne_inc_adm_rec = list()
cpt = 1
vec_val_s10 = c(0.1, 0.5, 0.75)

for (val_s10 in vec_val_s10) {
  setwd(str_c("s1.0_", val_s10,"/"))
  lst_ne_inc_adm_rec[[cpt]] = data.frame.increase.nu(seq_ne_ini, seq_combi, seq_nu)
  lst_ne_inc_adm_rec[[cpt]] = delta.adm.gen.0(lst_ne_inc_adm_rec[[cpt]])
  cpt = cpt + 1
  setwd("../")
}
```

```{r}

for (i in c(1:3)) {
  write_increase_plot(name_stat = "mean.het.adm", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/mean.he/Ne_inc/he_mean_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = 0.047,max_y = 0.065)
  write_increase_plot(name_stat = "Fst.s1.adm", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/Fst.s1.adm/Ne_inc/fst_s1_adm_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = 0,max_y = 0.1)
  write_increase_plot(name_stat = "Fst.s2.adm", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/Fst.s2.adm/Ne_inc/fst_s2_adm_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = 0,max_y = 0.1)
  write_increase_plot(name_stat = "mean.F.adm", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/mean.F/Ne_inc/F_mean_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = -0.03,max_y = 0.02)
  write_increase_plot(name_stat = "f3", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/f3/Ne_inc/f3_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = -0.05,max_y = 0.05)
  write_increase_plot(name_stat = "perc50.adm.props", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/mean.adm/Ne_inc/mean_adm_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = 0,max_y = 0.8)
  write_increase_plot(name_stat = "delta.adm.gen.0", mat = lst_ne_inc_adm_rec[[i]],
                      name_file =  str_c("pulse_recurrent/delta.adm0.adm/Ne_inc/delta_adm0_adm_ne_inc_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = -0.8,max_y = 0.8)
}
```


###Ne bottleneck
```{r}
setwd("../../SNP_YRI_GBR_adm_multi/pulse_recurrent/Ne_bot/")

lst_ne_bot_adm_rec = list()
cpt = 1
vec_val_s10 = c(0.1, 0.5, 0.75)

for (val_s10 in vec_val_s10) {
  setwd(str_c("s1.0_", val_s10,"/"))
  lst_ne_bot_adm_rec[[cpt]] = data.frame.bottleneck(lst_ne0 = c(1000), lst_nef = c(1000),
                                                    lst_alpha = c(0.1, 0.5, 0.9),
                                                    lst_nu = c(0.01, 0.25, 0.49),
                                                    lst_bottle = c(20, 50, 80), max_simu = 1)
  lst_ne_bot_adm_rec[[cpt]] = delta.adm.gen.0(lst_ne_bot_adm_rec[[cpt]])
  cpt = cpt + 1
  setwd("../")
}

```

```{r}
for (i in c(1:3)) {
  write_bottle_plot(name_stat = "mean.het.adm", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/mean.he/Ne_bot/he_mean_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                    min_y = 0.047,max_y = 0.065)
  write_bottle_plot(name_stat = "Fst.s1.adm", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/Fst.s1.adm/Ne_bot/fst_s1_adm_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                      min_y = 0,max_y = 0.1)
  write_bottle_plot(name_stat = "Fst.s2.adm", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/Fst.s2.adm/Ne_bot/fst_s2_adm_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                    min_y = 0,max_y = 0.1)
  write_bottle_plot(name_stat = "mean.F.adm", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/mean.F/Ne_bot/F_mean_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                    min_y = -0.03,max_y = 0.02)
  write_bottle_plot(name_stat = "f3", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/f3/Ne_bot/f3_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                    min_y = -0.05,max_y = 0.05)
  write_bottle_plot(name_stat = "perc50.adm.props", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/mean.adm/Ne_bot/mean_adm_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                    min_y = 0,max_y = 0.8)
  write_bottle_plot(name_stat = "delta.adm.gen.0", mat = lst_ne_bot_adm_rec[[i]],
                    name_file =  str_c("pulse_recurrent/delta.adm0.adm/Ne_bot/delta_adm0_adm_ne_bot_multi_s10_",
                                         vec_val_s10[i]),
                    min_y = -0.8,max_y = 0.8)
}
```


##Admixture ponctuelle

###Ne constante
```{r}
setwd("../../SNP_YRI_GBR_adm_multi/pulse_ponctuel/Ne_cst/")

lst_ne_cst_adm_pct = list()
cpt = 1
vec_val_s10 = c(0.1, 0.5, 0.75)

for (val_s10 in vec_val_s10) {
  setwd(str_c("s1.0_", val_s10,"/"))
  lst_ne_cst_adm_pct[[cpt]] = data.frame.stat(seq_ne = c(100,1000,10000),max_gen = 101, max_simu = 20)
  lst_ne_cst_adm_pct[[cpt]] = delta.adm.gen.0(lst_ne_cst_adm_pct[[cpt]])
  lst_ne_cst_adm_pct[[cpt]]$time_pulse_s1 = (rep(lst_ne_cst_adm_pct[[cpt]]$Generation[which(lst_ne_cst_adm_pct[[cpt]]$s1.0 != 0 & lst_ne_cst_adm_pct[[cpt]]$Generation != 0)], each = 101))
  lst_ne_cst_adm_pct[[cpt]]$time_pulse_s2 = (rep(lst_ne_cst_adm_pct[[cpt]]$Generation[which(lst_ne_cst_adm_pct[[cpt]]$s2.0 != 0 & lst_ne_cst_adm_pct[[cpt]]$Generation != 0)], each = 101))
  cpt = cpt + 1
  setwd("../")
}
```


```{r}
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "mean.het.adm",
                         min_y = 0.02, max_y = 0.063)

plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "mean.het.adm",
                         min_y = 0.02, max_y = 0.063, name_color = "time_pulse_s2")
```


```{r}
plot_adm_ponctuel_ne_cst_last_pulse(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "mean.het.adm",
                         min_y = 0.02, max_y = 0.063)
```

```{r}
plot_adm_ponctuel_ne_cst_minus(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "mean.het.adm",
                         min_y = 0.02, max_y = 0.063)
```


```{r}
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "Fst.s1.adm",
                         min_y = 0, max_y = 0.4,yas1 = 0.38,yas2 = 0.35)
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "Fst.s1.adm",
                         min_y = 0, max_y = 0.4,yas1 = 0.38,yas2 = 0.35,
                         name_color = "time_pulse_s2")
```

```{r}
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "Fst.s2.adm",
                         min_y = -0.01, max_y = 0.4,yas1 = 0.38,yas2 = 0.35)
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "Fst.s2.adm",
                         min_y = -0.01, max_y = 0.4,yas1 = 0.38,yas2 = 0.35,
                         name_color = "time_pulse_s2")
```

```{r}
plot_adm_ponctuel_ne_cst_minus(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "Fst.s2.adm",
                         min_y = -0.01, max_y = 0.4)
```


```{r}
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "f3",
                         min_y = -0.05,max_y = 0.8,yas1 = 0.75,yas2 = 0.69)
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "f3",
                         min_y = -0.05,max_y = 0.8,yas1 = 0.75,yas2 = 0.69,
                         name_color = "time_pulse_s2")
```


```{r}
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "var.adm.props",
                         min_y = -0.01, max_y = 0.15,yas1 = 0.14,yas2 = 0.125)
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "var.adm.props",
                         min_y = -0.01, max_y = 0.15,yas1 = 0.14,yas2 = 0.125,
                         name_color = "time_pulse_s2")
```


```{r}
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "delta.adm.gen.0",
                         min_y = -0.4, max_y = 0.4,yas1 = 0.38,yas2 = 0.35)
plot_adm_ponctuel_ne_cst(lst_mat = lst_ne_cst_adm_pct, seq_ne = c(100,1000,10000),
                         seq_s1 = c(0.1, 0.5, 0.75), name_stat = "delta.adm.gen.0",
                         min_y = -0.4, max_y = 0.4,name_color = "time_pulse_s2",
                         yas1 = 0.38,yas2 = 0.35)
```

##Ne croissant
```{r}
setwd("../../SNP_YRI_GBR_adm_multi/pulse_ponctuel/Ne_inc/")

lst_ne_inc_adm_pct = list()
cpt = 1
vec_val_s10 = c(0.1, 0.5, 0.75)

seq_nu = sprintf("%.2f", c(0.01, 0.25, 0.49))
seq_ne_ini = c(100)
seq_ne_fin = c(500,1000,10000)
seq_combi = as.data.frame(outer(seq_ne_ini, seq_ne_fin, FUN="paste", sep="-"))
seq_combi = as.data.frame.vector(unlist(seq_combi))[[1]]

for (val_s10 in vec_val_s10) {
  setwd(str_c("s1.0_", val_s10,"/"))
  lst_ne_inc_adm_pct[[cpt]] = data.frame.increase.nu(seq_ne_ini, seq_combi, seq_nu,max_simu = 20)
  lst_ne_inc_adm_pct[[cpt]] = delta.adm.gen.0(lst_ne_inc_adm_pct[[cpt]])
  lst_ne_inc_adm_pct[[cpt]]$time_pulse_s1 = (rep(lst_ne_inc_adm_pct[[cpt]]$Generation[which(lst_ne_inc_adm_pct[[cpt]]$s1.0 != 0 & lst_ne_inc_adm_pct[[cpt]]$Generation != 0)], each = 101))
  cpt = cpt + 1
  setwd("../")
}

```


```{r}
plot_adm_ponctuel_ne_inc = function(lst_mat, seq_ne, seq_s1, seq_u, name_stat, min_y, max_y, name_x = "Generation"){
  for (i in 1:length(lst_mat)) {
    for (ne in seq_ne) {
      for (u in seq_u) {
        mat_tmp = lst_mat[[i]][which(lst_mat[[i]]$Ne == ne),]
        mat_tmp = mat_tmp[which(mat_tmp$U ==  u),]
        num_col_y = which(colnames(mat_tmp) == name_stat)
        num_col_x = which(colnames(mat_tmp) == name_x)
    
        p=plot_stat_gen(df = mat_tmp, gen = mat_tmp[,num_col_x],
                        stat = mat_tmp[,num_col_y], group_col = as.factor(mat_tmp$simu), 
                        color_col = mat_tmp$time_pulse_s1, titre = str_c(name_stat," en fonction de ",name_x,
                                                               ", \ns1.0 = ", seq_s1[i], ", Ne = ", ne,
                                                               ", U = ",u))
        p=p+scale_color_gradientn(colours = c("#F7230C","orange","#F6DC12","#D1B606","#582900"))
        p=p+labs(color = "time pulse s1")  + guides(linetype = FALSE)
        p=p+ylim(min_y, max_y)
        
        vec_s1 = mat_tmp$time_pulse_s1[which(mat_tmp$Generation == 0)]
        for (rg_pulse in c(1:length(vec_s1))) {
          pos_x_s1 = vec_s1[rg_pulse]
          pos_y_s1 = mat_tmp[(rg_pulse-1)*101+1+pos_x_s1, num_col_y]
          p = p+geom_point(aes_string(x=pos_x_s1, y=pos_y_s1), colour="blue", shape = 17)
        }
        print(p)
      }
    }
  }
}
```


```{r}
plot_adm_ponctuel_ne_inc(lst_mat = lst_ne_inc_adm_pct, seq_ne = seq_combi,
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         name_stat = "mean.het.adm", min_y = 0.01, max_y = 0.065)
```


```{r}
plot_adm_ponctuel_ne_inc(lst_mat = lst_ne_inc_adm_pct, seq_ne = seq_combi,
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         name_stat = "Fst.s1.adm", min_y = -0.01, max_y = 0.5)
```

```{r}
plot_adm_ponctuel_ne_inc(lst_mat = lst_ne_inc_adm_pct, seq_ne = seq_combi,
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         name_stat = "f3", min_y = -0.1, max_y = 1.1)
```

```{r}
plot_adm_ponctuel_ne_inc(lst_mat = lst_ne_inc_adm_pct, seq_ne = seq_combi,
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         name_stat = "perc50.adm.props", min_y = -0.1, max_y = 1)
```


```{r}
plot_adm_ponctuel_ne_inc(lst_mat = lst_ne_inc_adm_pct, seq_ne = seq_combi,
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         name_stat = "var.adm.props", min_y = -0.01, max_y = 0.15)
```


```{r}
plot_adm_ponctuel_ne_inc(lst_mat = lst_ne_inc_adm_pct, seq_ne = seq_combi,
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         name_stat = "delta.adm.gen.0", min_y = -0.3, max_y = 0.5)
```


##Ne bottleneck
```{r}
setwd("../../SNP_YRI_GBR_adm_multi/pulse_ponctuel/Ne_bot/")

lst_ne_bot_adm_pct = list()
cpt = 1
vec_val_s10 = c(0.1, 0.5, 0.75)

for (val_s10 in vec_val_s10) {
  setwd(str_c("s1.0_", val_s10,"/"))
  lst_ne_bot_adm_pct[[cpt]] = data.frame.bottleneck(lst_ne0 = c(1000), lst_nef = c(1000),
                                                    lst_alpha = c(0.1, 0.5, 0.9),
                                                    lst_nu = c(0.01, 0.25, 0.49),
                                                    lst_bottle = c(20, 50, 80), max_simu = 20)
  lst_ne_bot_adm_pct[[cpt]] = delta.adm.gen.0(lst_ne_bot_adm_pct[[cpt]])
  lst_ne_bot_adm_pct[[cpt]]$time_pulse_s1 = (rep(lst_ne_bot_adm_pct[[cpt]]$Generation[which(lst_ne_bot_adm_pct[[cpt]]$s1.0 != 0 & lst_ne_bot_adm_pct[[cpt]]$Generation != 0)], each = 101))
  cpt = cpt + 1
  setwd("../")
}


```


```{r}
plot_adm_ponctuel_ne_bot = function(lst_mat, seq_ne, seq_s1, seq_u, seq_alpha,
                                    seq_bot, name_stat, min_y, max_y, name_x = "Generation"){
  for (i in 1:length(lst_mat)) {
    for (ne in seq_ne) {
      for (u in seq_u) {
        for (alpha in seq_alpha) {
          for (bot in seq_bot) {
            mat_tmp = lst_mat[[i]][which(lst_mat[[i]]$Ne == ne),]
            mat_tmp = mat_tmp[which(mat_tmp$U ==  u),]
            mat_tmp = mat_tmp[which(mat_tmp$alpha ==  alpha),]
            mat_tmp = mat_tmp[which(mat_tmp$time_botl ==  bot),]
            num_col_y = which(colnames(mat_tmp) == name_stat)
            num_col_x = which(colnames(mat_tmp) == name_x)
        
            p=plot_stat_gen(df = mat_tmp, gen = mat_tmp[,num_col_x],
                            stat = mat_tmp[,num_col_y], group_col = as.factor(mat_tmp$simu), 
                            color_col = mat_tmp$time_pulse_s1,
                            titre = str_c(name_stat," en fonction de ",name_x,
                                          ", \ns1.0=", seq_s1[i], ",Ne=", ne,
                                          ",U=",u, ",a=",alpha,",b=",bot))
            p=p+scale_color_gradientn(colours = c("#F7230C","orange","#F6DC12","#D1B606","#582900"))
            p=p+labs(color = "time pulse s1")  + guides(linetype = FALSE)
            p=p+ylim(min_y, max_y)
            
            vec_s1 = mat_tmp$time_pulse_s1[which(mat_tmp$Generation == 0)]
            for (rg_pulse in c(1:length(vec_s1))) {
              pos_x_s1 = vec_s1[rg_pulse]
              pos_y_s1 = mat_tmp[(rg_pulse-1)*101+1+pos_x_s1, num_col_y]
              p = p+geom_point(aes_string(x=pos_x_s1, y=pos_y_s1), colour="blue", shape = 17)
            }
            
            print(p)
          }
        }

      }
    }
  }
}
```


```{r}
plot_adm_ponctuel_ne_bot(lst_mat = lst_ne_bot_adm_pct, seq_ne = c("1000-1000"), 
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         seq_alpha = c(0.1),seq_bot = c(20,50,80),
                         name_stat = "mean.het.adm",min_y = 0.01,max_y = 0.07)
```

```{r}
plot_adm_ponctuel_ne_bot(lst_mat = lst_ne_bot_adm_pct, seq_ne = c("1000-1000"), 
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         seq_alpha = c(0.1),seq_bot = c(20,50,80),
                         name_stat = "perc50.adm.props",min_y = -0.1,max_y = 1)
```

```{r}
plot_adm_ponctuel_ne_bot(lst_mat = lst_ne_bot_adm_pct, seq_ne = c("1000-1000"), 
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         seq_alpha = c(0.1),seq_bot = c(20,50,80),
                         name_stat = "var.adm.props",min_y = -0.01,max_y = 0.15)
```


```{r}
plot_adm_ponctuel_ne_bot(lst_mat = lst_ne_bot_adm_pct, seq_ne = c("1000-1000"), 
                         seq_s1 = c(0.1, 0.5, 0.75), seq_u = c(0.01, 0.25, 0.49),
                         seq_alpha = c(0.1),seq_bot = c(20,50,80),
                         name_stat = "delta.adm.gen.0",min_y = -0.3,max_y = 0.5)
```


```{r}
print(difftime(Sys.time(), time.ini))
```
